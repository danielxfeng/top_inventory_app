<!DOCTYPE html>
<html lang="en">
  <%- include("partials/head.ejs", { title: title }) %>
  <body>
    <%- include("partials/header.ejs", { title: title }) %>
    <main>
      <h1><%= title %></h1>
      <div>
        <% if (errors && errors.length > 0) { %>
          <%-include("partials/error.ejs", { errors: errors }) %>
        <% } %>
        <% if (data && data.length > 0) { %>
        <table>
          <caption>
            Table of <%= title %>
          </caption>
          <thead>
            <tr>
              <% Object.keys(data[0]).forEach(key => { %>
              <th><%= key %></th>
              <% }) %>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% data.forEach(row => { %>
            <tr>
              <% Object.values(row).forEach(value => { %>
              <td><%= value %></td>
              <% }) %>
              <td>
                <a href="<%= `/${link}/update/${row.id}` %>">Update</a>
                <form action="<%= `/${link}/${row.id}` %>" method="POST">
                  <input type="hidden" name="_method" value="DELETE">
                  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                  <button type="submit">Delete</button>
                </form>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
        <% } else { %>
        <p>No data available</p>
        <% } %>
      </div>
      <a href="<%= `/${link}/new` %>">New</a>
    </main>
    <%- include("partials/footer.ejs") %>
  </body>
</html>
